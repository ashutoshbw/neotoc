import { IndentLineGapSlider } from "@/components/toc/indent-line-gap-slider";
import { RelativeFontSizeSlider } from "@/components/toc/relative-font-size-slider";
import { AutoFoldSwitch } from "@/components/toc/auto-fold-switch";
import { EllipsisSwitch } from "@/components/toc/ellipsis-switch";

Neotoc creates a TOC(Table of Contents) UI by parsing the DOM inside the browser.

The TOC you see on the right is made with neotoc. It's main features are:

- __Fluid highlight of the view__ and __auto scrolling of TOC__.
- Both __manual__ and __auto folding__ support.
- __Easily stylable__ with dozens of CSS variables.
- __TypeScript support__.
- __Accessible__.
- __Zero dependency__.
- __Performant__ and __Lightweight__.
- __Framework agnostic__. You can use it in vanilla HTML CSS JS setup to frameworks like Next.js. This is doc is made with Next.js.

If you find this tool useful, <a className="text-blue-600 dark:text-blue-400 hover:underline" href="https://github.com/ashutoshbw/neotoc" target="_blank">please give it a ‚≠ê on Github</a>!


## Appetizer üòã

Here are some controllers I made for you to easily experience its customizability:

- <RelativeFontSizeSlider />
- <IndentLineGapSlider />
- Turn on/off Auto folding: <AutoFoldSwitch />
- Turn on/off ellipsis for long headings: <EllipsisSwitch />

There are many many more things that you can do. But that's for the rest of this doc. I hope you are now as excited to try it out as I'm to share it with you.

## Quick start guide: _It is just three lines away_

Here I'm writing this quick start guide in the context of Vite's `vanilla` template for simplicity.

So after setting up your project, install `neotoc`(with the package manager you are using. I'm using `pnpm` here cause its my favorite):

```sh
pnpm add neotoc
```

Now in your JavaScript file do the following `import`s and call `neotoc` like below:

```js
import neotoc from "neotoc";
import "./neotoc.css";

neotoc({ io: "article >> h* >> aside" });
```

Neotoc doesn't ship any CSS with the package to allow you to style it freely. However you don't have to write it from scratch. I've already written the CSS I find appealing. So copy it form Github and paste it in `neotoc.css`(or whatever filename you choose) and tweak it as you like it.

Now to create TOC, we must call `neotoc` with the `io`(i.e. input output) option. Here you have to give the answer of three questions in the form of _CSS selectors_ seperated by `>>`:
1. ___Where should it look for headings?___
    - Here it is the `article` element.
2. ___Which headings should it consider for creating the TOC?___
    - Here it is `h*`, which means headings of all levels.(Though it's not a valid CSS selector, it's special shortcut that is allowed here).
3. ___Where should it append the the created TOC?___
    - Here it is the `aside` element.

If you didn't have `article`, heading elements in it and `aside`, create them in your HTML. And make sure those headings have unique ids. Then you should see the TOC in the `aside` element.

Note that to get things work nicely Neotoc expect two things:
- Heading that you look for must have ids.
- And those headings should appear in a sensible order. By sensible order, I mean:
  - First found heading's level is considered the largest one. So if you choose `<h2>` as your first heading, you must not use the `<h1>` heading later.
  - There must be no gap between two heading levels when going top to bottom. So, after `<h2>` you should not use the heading `<h4>`.

Now you have good a foundational knowledge about it. Let's now dive into its API.

## Neotoc API

`neotoc` package only has a default export. It's the function that you call to create the toc. Here we will name this function as `neotoc` too:

```js
import neotoc from "neotoc";
```

`neotoc` takes a options object and returns a cleaup function.

If you are using `neotoc` in React or other library/framework, you will probably need to call or return this function where it is needed. For React for example, the pattern is like below:

```tsx
useEffect(() => {
  const removeNeotoc = neotoc({
    io: "article >> h2,h3,h4,h5,h6 >> aside"
  });

  return () => {
    removeNeotoc();
  };
}, []);
```

In you have a vanilla HTML CSS JS setup you usually don't need use the cleanup function.

Now, let's see all of its options in detail.

### Options

#### `io` and `to`

Type of `io`: `string`<br/>
Type of `to`: `HTMLElement`

`io` is the ___only required___ option. We have already covered it mostly in the [Quick Start guide](#quick-start-guide-it-is-just-three-lines-away). Let's cover the rest here.

The last part of the `io` can be ommitted if there is a need to provide the corresponding HTML element directly. We can use the `to` option for that purpose.

One use case of `to` option is that it allows you to easily create a wrapper component for it in React:

```tsx
function Neotoc({
  from,
  className,
}: {
  from: string;
  className?: string;
}) {
  const toRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    return neotoc({ io: `${from} >> h*`, to: toRef.current! });
  }, [from]);
  return <div ref={toRef} className={className}></div>;
}
```

Note that if the 3rd part of the `io` option is specified, `to` option is ignored.

#### `title`

Type: `string`<br />
Default value: `"On this page"`

The title of the TOC UI that appears on the top left of it.

#### `fillAnchor`

Type: `(heading: HTMLHeadingElement) => string | Node`<br />
Default value: `(heading) => heading.textContent`

It is used to determine the content of anchors elements in the TOC. If your headings have complex structure or contain elements like `<code>` or `<i>`  like in this doc and you want to show them in the TOC, this option can be useful.

__Tip__: You can't have the same node in two places in the DOM. You will need to [clone](https://developer.mozilla.org/en-US/docs/Web/API/Node/cloneNode) it.

#### `ellipsis`

Type: `boolean`<br />
Default value: `false`

If `true`, long heading's text is truncated with ... instead of wrapping it to the next line. If you hover of the anchor the full text is shown in the browser default tooltip.

#### `classPrefix`

Type: `string`<br />
Default value: `nt-`

All the CSS classes assigned to different elements in the TOC UI are by default prefixed with `nt-` as an attempt to avoid class name collision.

This the `nt-` prefix is already used in class names of other elements of your page, you should set a different value here. And in your CSS for neotoc, you will also have to replace all occurances of `nt-` with your chosen prefix.

#### `initialFoldLevel`

Type: `number`<br />
Default value: `6`

It should be a number from `1` to `6`.

If it is `1`, `<h1>` and all lower level heading's corresponding sections in the TOC will be folded initially.

If it is `2`, `<h2>` and all lower level heading's corresponding sections in the TOC will be folded initially.

And so on.

Note that if it is `6` everything is unfolded initially since there is no `<h7>`.

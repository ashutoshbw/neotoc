# Neotoc Docs

Crafting a smoothly animated and interactive table of contents for your docs or blog is no trivial task. That’s where Neotoc comes in—enabling you to create an enjoyable TOC UI with minimal effort.

## Getting started

Getting started with Neotoc depends on your project setup. There are two main ways to use Neotoc:

- If you have a vanilla setup, you can use a CDN like [jsDelivr](https://www.jsdelivr.com/package/npm/neotoc).
- If your project uses a bundler, you will most likely want to install it via a package manager (e.g., `npm`, `pnpm`, or `yarn`).

In this guide, I'll cover the getting started section in the context of Vite's `vanilla` template for simplicity. You can easily set one up by running `npm create vite` in your terminal and following the prompts. For more details, refer to [Scaffolding Your First Vite Project](https://vite.dev/guide/#scaffolding-your-first-vite-project).

After setting up your project, install `neotoc` using the package manager of your choice:

```sh
npm install neotoc
# or
pnpm add neotoc
# or
yarn add neotoc
```

In your JavaScript/TypeScript file(most likely `main.js`/`main.ts`), add the following import statements and call `neotoc` as shown below:

```js
import neotoc from "neotoc";
import "./neotoc.css";

neotoc({ io: "article >> h* >> aside" });
```

Neotoc doesn’t include any CSS by default, giving you complete freedom to style it however you like. That said, you don’t need to start from scratch. You can use the stylesheet I’ve written for this site as a starting point. [Copy it from GitHub](https://github.com/ashutoshbw/neotoc/blob/main/apps/www/src/app/docs/neotoc.css), paste it into `neotoc.css` (or any filename of your choice), and customize it to suit your needs.

To create a TOC, you must call `neotoc` with the `io` (input-output) option. Here, you need to answer three questions using CSS selectors separated by `>>`:

1. ___Where should it look for headings?___
    - In this case, it's the `article` element.
2. ___Which headings should it consider for creating the TOC?___
    - Here, it's `h*`, which means headings of all levels. (Although it's not a valid CSS selector, it's a special shortcut allowed here.)
3. ___Where should it append the created TOC?___
    - Here, it's the `aside` element.

If your HTML does not include an `<article>` element with headings inside it or an `<aside>` element, create them. Ensure the headings have unique IDs. Once these elements are in place, you should see the TOC in the `<aside>` element.

Note that for Neotoc to work properly, it expects two things:

- The headings you target must have unique IDs.
- The headings must appear in a logical order. By logical order, I mean:
  - The first heading found determines the highest level. For example, if you start with an `<h2>` heading, you should not use an `<h1>` heading later.
  - There should be no gaps between heading levels when progressing from top to bottom. For instance, after an `<h2>`, you should not use an `<h4>` without including an `<h3>` in between.

That's everything you need to know to get started with Neotoc.

## Neotoc API

You can import the TOC UI generator function directly from the package as shown below:

```js
import neotoc from "neotoc";
```

You can rename `neotoc` to something else if you wish, as it is a default export.

`neotoc` accepts an options object and returns a cleanup function.

If you're using Neotoc in React or another library/framework, you'll likely need to call or return this function where it is required. For example, in React, the pattern looks like this:

```tsx
useEffect(() => {
  const removeNeotoc = neotoc({
    io: "article >> h2,h3,h4,h5,h6 >> aside"
  });

  return () => {
    removeNeotoc();
  };
}, []);
```

If you are working with a vanilla HTML, CSS, and JS setup, you typically won't need to use the cleanup function.

Now, let's explore all of its options in detail.

### Options

#### `io` and `to`

Type of `io`: `string`<br/>
Type of `to`: `HTMLElement`

`io` is the ___only required___ option. We have already covered it mostly in the [Getting started](#getting-started) section. Let's cover the rest of the details here.

The last part of the `io` value can be _omitted_ if you need to provide the corresponding HTML element directly. You can use the `to` option for this purpose.

One use case of the `to` option is that it allows you to easily create a wrapper component for it in React:

```tsx
function Neotoc({
  from,
  className,
}: {
  from: string;
  className?: string;
}) {
  const toRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    return neotoc({ io: `${from} >> h*`, to: toRef.current! });
  }, [from]);
  return <div ref={toRef} className={className}></div>;
}
```

Note that if the 3rd part of the `io` option is specified, `to` option is ignored.

#### `title`

Type: `string`<br />
Default value: `"On this page"`

The title of the TOC UI that appears at the top left of it.

#### `fillAnchor`

Type: `(heading: HTMLHeadingElement) => string | Node`<br />
Default value: `(heading) => heading.textContent`

It is used to determine the content of anchor elements in the TOC. If your headings have a complex structure or contain elements like `<code>` or `<i>`, as seen on this page, and you want to display them in the TOC, this option can be useful.

__Tip__: You can't have the same node in two places in the DOM. You will need to [clone](https://developer.mozilla.org/en-US/docs/Web/API/Node/cloneNode) it.

#### `onBreadcrumbChange`

Type: `(data: Breadcrumb) => void`<br />
Default value: `() => {}`

Here `Breadcrumb` type is:

```ts
type Breadcrumb = {
  content: string | Node;
  hash: string;
}[]
```

You can also import the type from Neotoc if needed.

This option allows you to create a breadcrumb similar to the one displayed in the header of this page. Neotoc provides the data at the right time but leaves the breadcrumb construction in your hands.

The value of `content` depends on what is returned from the `fillAnchor` option. You will need the `hash` if you want to create links for the breadcrumb items to jump to the parent section.

Note: Since Neotoc leaves breadcrumb construction to you, you will also need to clean up any side effects, if required. This is typically necessary when using it with a frontend library or framework.

#### `ellipsis`

Type: `boolean`<br />
Default value: `false`

If `true`, overflowed text is truncated with ... instead of wrapping to the next line. When you hover over the anchor, the full text is displayed in the browser's default tooltip.

__Tip__: When using `fillAnchor` with cloned heading nodes containing `<code>` elements, set their position to `static` in the TOC if it's not, to ensure the ellipsis appears correctly.

#### `classPrefix`

Type: `string`<br />
Default value: `nt-`

All CSS classes assigned to elements in the TOC UI are prefixed with `nt-` by default to avoid class name collisions.

If the `nt-` prefix is already used in class names elsewhere on your page, you should set a different value here. Additionally, you'll need to update your Neotoc CSS to replace all occurrences of `nt-` with your chosen prefix.

#### `initialFoldLevel`

Type: `number`<br />
Default value: `6`

It should be a number from `1` to `6`.

If it is `1`, `<h1>` and all lower-level headings' corresponding sections in the TOC will be folded initially.

If it is `2`, `<h2>` and all lower-level headings' corresponding sections in the TOC will be folded initially.

And so on.

Note that if it is `6`, everything is unfolded initially since there is no `<h7>`.

#### `offsetTop` and `offsetBottom`

Type of both: `number`<br />
Unit: `px`<br />
Default value of both: `0`

Neotoc considers the portion of the nearest scroll container(usually the `<html>` element) cropped by the screen as its viewport.

This viewport is reflected in the TOC to highlight the relevant area.

You can lower the top edge of this viewport using the `offsetTop` option and raise the bottom edge of the viewport using `offsetBottom`.

This is useful if you have a fixed header or footer.

Note: Here "nearest scroll container" refers to the nearest scroll container of the element matched by the first part of the `io` option.

__Tip__: If you have a fixed header, to ensure the headings scroll to the correct position, you can use the CSS [`scroll-margin-top`](https://developer.mozilla.org/en-US/docs/Web/CSS/scroll-margin-top) property on the heading elements.

#### `autoFold`

Type: `boolean`<br />
Default value: `false`

Whether or not to automatically fold/unfold the TOC based on what is in the viewport.

#### `autoScroll`

Type: `boolean`<br />
Default value: `true`

Whether or not to automatically scroll the TOC to keep the highlighted portion in view when the nearest scroll container is scrolled.

#### `autoScrollOffset`

Type: `number`<br />
Unit: `px`<br />
Default value: `50`

When `autoScroll` is `true`, this option allows you to control the distance the highlighted area should stay from the top and bottom edges of the main TOC UI (the element that by default has the class `.nt-body`) when possible.

#### `toggleFoldIcon`

Type: `string`<br />
Default value: [Chevron down icon(SVG)](https://icon-sets.iconify.design/charm/chevron-down/)

This icon is shown at the left of each anchor text on the TOC which has sub anchors underneath it to allow you to fold/unfold it. You can set another SVG icon here with this option.

#### `unfoldableIcon`

Type: `string`<br />
Default value: [Dot icon(SVG)](https://icon-sets.iconify.design/lucide/dot/)

This icon is shown at the left of each anchor text on the TOC which do not have sub anchors underneath it. You can set another SVG icon here with this option.

#### `foldIcon`

Type: `string`<br />
Default value: [Unfold less rounded icon(SVG)](https://icon-sets.iconify.design/material-symbols/unfold-less-rounded/)

This is used on the fold button on the header of the TOC. You can set another SVG icon here with this option.

#### `unfoldIcon`

Type: `string`<br />
Default value: [Unfold more rounded icon(SVG)](https://icon-sets.iconify.design/material-symbols/unfold-more-rounded/)

This is used on the unfold button on the header of the TOC. You can set another SVG icon here with this option.

#### `foldAllIcon`

Type: `string`<br />
Default value: [Unfold less double rounded icon(SVG)](https://icon-sets.iconify.design/material-symbols/unfold-less-double-rounded/)

This is used on the fold all button on the header of the TOC. You can set another SVG icon here with this option.

#### `unfoldAllIcon`

Type: `string`<br />
Default value: [Unfold more double rounded icon (SVG)](https://icon-sets.iconify.design/material-symbols/unfold-more-double-rounded/)

This is used on the unfold all button on the header of the TOC. You can set another SVG icon here with this option.

## Theming 🎨

I recommend you to [copy the style for the toc](https://github.com/ashutoshbw/neotoc/blob/main/apps/www/src/components/toc/neotoc.css) that ou see on the right, and modify it based on your need because this is the style that I always try to keep updated and polished as much as I can.

The goal of this section is to make yourself familiar with this stylesheet. It will not be a exhaustive overview. I will only include things that you most likely want to modify.

The stylesheet has two main parts:
- __`SETTINGS`__: Things that you will usually want to modify, like colors, and size of stuffs and folding duration.
- __`NEOtoc STYLE`__: Styles that define the structure of the toc and subtle details.

Here I will mainly discuss about the `SETTINGS` part. I'm leaving the rest of the CSS file for you to explore and understand according to your need.

Let's start with light/dark theme.

### Light/dark mode colors

You have to use CSS variables(aka custom properties) for this. The default class name for the toc widget is `.nt-widget`. You should declare colors for light/dark theme via CSS variables here. In the stylesheet it's done like below:

```css
:root.light .nt-widget {
  /* light mode color definitions */
}
:root.dark .nt-widget {
  /* dark mode color definitions */
}

/* styles for medium sized screen and above */
@media (min-width: 768px) {
  :root.light .nt-widget {
  }
  :root.dark .nt-widget {
  }
}
```

Note it's done in a mobile first approach. Here light/dark theme is determined by whether the `.light` or `.dark` class is present on `<html>` element. Here change the selector to match how you differenciate light/dark theme for your website.

The CSS variable names are descriptive and I hope you will easily figure out where they relate to.

I defined the colors in [HSL](https://www.smashingmagazine.com/2021/07/hsl-colors-css/) because, it's very easy to tweak them. But you can use any other color format of your preference.

Now let's move on to the sizing of stuffs.


You have the following color related CSS variables at your disposal. Hover over the variable names to highlight relevant part in the toc on the left in <span className="green-sample-color">green</span>. (Note that states like `hover`, `active`, `disabled` are ignored in highlighting to help you see the things it can ___possibly___ target. When you set color values to such variables they are only applied in the corresponding state.)

- `--bg`: Applies background color all the elements that are highlighted when you hover over the variable name on the left.
- `--fg`: Applies text and icon color.
- `--bg-anchor-hover`: Anchor's background color in hover state.
- `--bg-anchor-active`: Anchor's background color in active state.
- `--bg-sub-anchors`: To see the highlight you will need to unfold/expand a section in the toc.
- `--bg-header-btn`
- `--bg-header-btn-hover`
- `--bg-header-btn-active`
- `--bg-header-btn-disabled`
- `--fg-header-btn-disabled`
- `--border-header-btn`
- `--bg-toggle-fold-btn-hover`
- `--bg-toggle-fold-btn-active`
- `--indent-line`: Note that it applies color to actually a border.
- `--indent-line-highlight`: It applies when you over of the parent toggle fold button.
- `--fold-indicator-gradient-mid`: To see it, fold a section in the toc.
- `--light-bar`
- `--light-bar-tip-on-fold`
- `--light-opacity`

### Sizing and Timing

Here again, we use CSS variables in the `.nt-widget` class(by default) to define these things. The variables are:

- `--height`
- `--header-height`
- `--relative-font-size`
- `--toggle-fold-btn-width`
- `--indent-line-gap`
- `--indent-line-width`
- `--anchor-padding-block`
- `--anchor-padding-inline`
- `--anchor-border-radius`
- `--padding-left`
- `--light-bar-width`
- `--light-bar-tip-radius`
- `--light-spread-length`
- `--folding-duration`

#### `--height`

It describes the total height of the toc widget(the element having the class `.nt-widget` by default). (Actually it's the maximum height. But you can change easily if you want. We well see that in the next section.)

I've written it's value tailored for this website(i.e. with the help of external CSS variables). You can use any length value for the height as your need.

Note that toc widget is composed of two things:

- Header of the toc (having the title and fold buttons). It has the class `nt-header` by default.
- Body of the toc. It has the class `nt-body` by default.

#### `--header-height`

I use a fixed height for this, which makes it possible to use `--height` to determine to full height of the toc widget:

```css
/* This is in the FOUNDATION section */
.nt-body {
  max-height: calc(var(--height) - var(--header-height));
}
```

If you need want it be exact height, just use `height` instead of `max-height`.


## Support <span className="text-[0.8em] animate-pulse">❤️</span>

If you think this provides a good user experience and want this project to succeed, please support it by [giving it a ⭐ on Github](https://github.com/ashutoshbw/neotoc)!
